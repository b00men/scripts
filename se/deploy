Деплой новых серверов

TODO: добавить различие для касперского, тестцентров и прочих (каких прочих?)

1) Создаем VM в нужной локации с нужным хостнеймом, обычно 2GB оперативки (~20$), оба ключа ансибла

2) Добавили в DNS на Амазоне

На ansible
3) Правим /etc/ansible/hosts: Добавляем новые сервера в основные группы, добавляем их хосты в свою группу.

4) Обновляем и устанавливаем питон на новых клиентах

mkdir -m=700 /root/.ssh
echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCp7iXVpYobxczea8WmnEttRzJyapus8xQkt87mC5cr3OwrptK7Fd1M5DLo4uL99oLjJuC00iGbPNT6K80YDFzCEZoqEGuzqln3EjWZO6IgYtwUuYj9M7i1D6QaGFJZB+mdx0YrDPpZh+lADTTZqgwbnVzlHuOV9s3XBJk1aY28VMsdBzOeEKkmlSvLvM03nUMYYlfLocyHITf/tBoo3DfjXDaGmNX932QcgYq9zI+i3SxkGwAeDMGxCZXuXZXJla2D0gxG7+4PFIkfQGRNmmz0JqgOVDDiV2BaCUAzYi15WaUkDYW81wbF6sxnVg1JEzO8chWnoh7K2wtl+tJE1TBp ansible.sibedge.com" >> /root/.ssh/authorized_keys
echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDGXZDn5KzWuv0AHME7ijhsieTjOByjbdGRjvoYBqEG5b0eKROGCEOH04sCB5lGMqDlOFxHY62DqKEuzuxRwW6qeyVXN4pSKvILQjBYaehQuipfrVEFzoYLIETum3zbK32sTUbKTBwDUMfe0UHMMr4T36aTqGqutfsDQ6aO/z8mOy1WfKX5R6Rf6GJg63Ws8bRBSfuaw13yqsEDLQUr30Aih5YUFJU0Ih9ggZQU/CcIVPP7VbhRnCPlzt+RqcdItPhIAPLjzSNinwsayH6lQjwxxgHxV5yfTwIPwaN/ooy2Os7Tuw6e4EX7OiaYcLt7GDoy0EMQI9vPuE2f27166DPL ansible-anchorfree" >> /root/.ssh/authorized_keys
chmod 600 /root/.ssh/authorized_keys
apt-get update &&  apt-get install aptitude python python2.7 mc -y && aptitude full-upgrade -y && apt-get autoremove -y && apt-get autoclean && shutdown -r now

5) Правим ./playbook/multiserver_deploy.yml: ставим свою группу, проверяем роли.

6) из /etc/ansible/playbook исполняем ansible-playbook multiserver-deploy.yml

7) Для касперского добовляем сервер в тесты

8) Добавляем в проверки nagios.northghost.com:/etc/nagios3/hosts/TouchVPN
типа cat do-tv-sg-singapore-2.cfg | sed -e 's/2/3/' > do-tv-sg-singapore-3.cfg

9) Добавляем в графану ручками, через аккаунт админа в соответсвующие дашборды в соответсвующие датацентры 

10) Добавляем в GoogleDocs в Servers